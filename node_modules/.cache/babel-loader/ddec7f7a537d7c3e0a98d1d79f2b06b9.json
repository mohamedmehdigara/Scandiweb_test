{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\p-c\\\\Downloads\\\\Github\\\\Scandiweb_test\\\\src\\\\components\\\\product\\\\productSingle.js\";\nimport React from 'react';\nimport './product.css';\nimport AttrSet from '../AttrSet/AttrSet';\nimport Gallery from './Gallery/Gallery';\nimport ProductPrice from './ProductPrice/ProductPrice';\nimport cartStore from '../../redux/CartState';\nimport ReactHtmlParser from 'react-html-parser';\nimport { useQuery } from '@apollo/client';\nimport { PRODUCT_SINGLE } from '../queries';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction injectProduct(Component) {\n  var _s = $RefreshSig$();\n\n  const InjectedProduct = function (props) {\n    _s();\n\n    const {\n      data\n    } = useQuery(PRODUCT_SINGLE, {\n      variables: {\n        id: props.match.params.id\n      }\n    });\n    const product = data !== null && data !== void 0 && data.product ? data.product : undefined;\n    return /*#__PURE__*/_jsxDEV(Component, {\n      product: product\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 16,\n      columnNumber: 12\n    }, this);\n  };\n\n  _s(InjectedProduct, \"wDefygpsWBVTl/fEL2emlq2/574=\", false, function () {\n    return [useQuery];\n  });\n\n  return InjectedProduct;\n}\n\nclass productSingle extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      item: this.props.product,\n      attrPicked: false\n    };\n    this.addToCart = this.addToCart.bind(this);\n    this.setAttr = this.setAttr.bind(this);\n  }\n\n  addToCart(item) {\n    const atrobj = {};\n    this.state.item.attributes.forEach(atr => {\n      atrobj[atr.name] = this.state[atr.name];\n    });\n    const newItem = JSON.parse(JSON.stringify(item));\n    newItem.pickedAttrs = atrobj;\n    newItem.itemCount = 1;\n\n    if (this.findSimilar(newItem) !== -5) {\n      cartStore.dispatch({\n        type: 'INCREMENT',\n        payload: this.findSimilar(newItem)\n      });\n    } else {\n      cartStore.dispatch({\n        type: 'ADD_PRODUCT',\n        payload: newItem\n      });\n    }\n  }\n\n  findSimilar(newItem) {\n    let k = -5;\n    cartStore.getState().cartItems.forEach((element, index) => {\n      if (JSON.stringify(element.pickedAttrs) === JSON.stringify(newItem.pickedAttrs) && element.name === newItem.name) {\n        k = index;\n      }\n    });\n    return k;\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.product !== prevProps.product) {\n      this.setState({\n        item: this.props.product\n      });\n    }\n  }\n\n  componentDidMount() {\n    if (this.state.item) {\n      const attributes = this.state.item.attributes;\n\n      if (!attributes.length) {\n        this.setState({\n          attrPicked: true\n        });\n      }\n\n      attributes.forEach(attr => {\n        this.setState({\n          [attr.name]: null\n        });\n      });\n    }\n  }\n\n  setAttr(item, name) {\n    this.setState({\n      attrPicked: true\n    });\n    this.setState({\n      [name]: item.value\n    });\n  }\n\n  render() {\n    const product = this.state.item;\n    const stock = this.state.attrPicked && product.inStock;\n    return product ? /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"product-container\",\n        children: [/*#__PURE__*/_jsxDEV(Gallery, {\n          gallery: product.gallery,\n          stock: product.inStock\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"product-about\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"single-product-name\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: product.brand\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 88,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: product.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 89,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 87,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"single-product-attributes\",\n            children: !product.attributes.length ? null : product.attributes.map((item, index) => /*#__PURE__*/_jsxDEV(AttrSet, {\n              item: item,\n              setAttr: this.setAttr\n            }, `${item.name}_${index}`, false, {\n              fileName: _jsxFileName,\n              lineNumber: 95,\n              columnNumber: 21\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 91,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(ProductPrice, {\n            prices: product.prices\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            disabled: !stock,\n            className: `add-to-cart-single ${!stock ? 'btn-disabled' : ''}`,\n            onClick: () => {\n              this.addToCart(product);\n            },\n            children: \"add to cart\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 104,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"single-product-description\",\n            children: ReactHtmlParser(product.description)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 110,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 12\n    }, this) : null;\n  }\n\n}\n\nexport default injectProduct(productSingle);","map":{"version":3,"names":["React","AttrSet","Gallery","ProductPrice","cartStore","ReactHtmlParser","useQuery","PRODUCT_SINGLE","injectProduct","Component","InjectedProduct","props","data","variables","id","match","params","product","undefined","productSingle","constructor","state","item","attrPicked","addToCart","bind","setAttr","atrobj","attributes","forEach","atr","name","newItem","JSON","parse","stringify","pickedAttrs","itemCount","findSimilar","dispatch","type","payload","k","getState","cartItems","element","index","componentDidUpdate","prevProps","setState","componentDidMount","length","attr","value","render","stock","inStock","gallery","brand","map","prices","description"],"sources":["C:/Users/p-c/Downloads/Github/Scandiweb_test/src/components/product/productSingle.js"],"sourcesContent":["import React from 'react'\r\nimport './product.css'\r\nimport AttrSet from '../AttrSet/AttrSet'\r\nimport Gallery from './Gallery/Gallery'\r\nimport ProductPrice from './ProductPrice/ProductPrice'\r\nimport cartStore from '../../redux/CartState'\r\nimport ReactHtmlParser from 'react-html-parser'\r\nimport { useQuery } from '@apollo/client'\r\nimport { PRODUCT_SINGLE} from '../queries'\r\n\r\n\r\nfunction injectProduct (Component) {\r\n  const InjectedProduct = function (props) {\r\n    const {data} = useQuery(PRODUCT_SINGLE,{variables: {id: props.match.params.id}}); \r\n    const product = data?.product  ? data.product : undefined;\r\n    return <Component product = {product} />\r\n  }\r\n  return InjectedProduct\r\n}\r\n\r\nclass productSingle extends React.Component {\r\n  constructor (props) {\r\n    super(props)   \r\n    this.state = { item: this.props.product, attrPicked: false }    \r\n    this.addToCart = this.addToCart.bind(this)\r\n    this.setAttr = this.setAttr.bind(this)\r\n  }\r\n\r\n  addToCart (item) {\r\n    const atrobj = {}\r\n    this.state.item.attributes.forEach((atr) => {\r\n      atrobj[atr.name] = this.state[atr.name]\r\n    })\r\n    const newItem = JSON.parse(JSON.stringify(item))\r\n    newItem.pickedAttrs = atrobj\r\n    newItem.itemCount = 1\r\n    if (this.findSimilar(newItem) !== -5) {      \r\n      cartStore.dispatch({ type: 'INCREMENT', payload: this.findSimilar(newItem) })\r\n    } else {\r\n      cartStore.dispatch({ type: 'ADD_PRODUCT', payload: newItem })\r\n    }\r\n  }\r\n\r\n  findSimilar (newItem) {\r\n    let k = -5\r\n    cartStore.getState().cartItems.forEach((element, index) => {\r\n      if (JSON.stringify(element.pickedAttrs) === JSON.stringify(newItem.pickedAttrs) &&\r\n      element.name === newItem.name) {\r\n        k = index\r\n      }\r\n    })\r\n    return k\r\n  }\r\n\r\n  componentDidUpdate (prevProps) {\r\n    if (this.props.product !== prevProps.product) { \r\n      this.setState({ item: this.props.product })\r\n    }\r\n  }\r\n\r\n  componentDidMount () {\r\n    if (this.state.item) {\r\n      const attributes = this.state.item.attributes\r\n      if (!attributes.length) {\r\n        this.setState({ attrPicked: true })\r\n      }\r\n      attributes.forEach((attr) => {\r\n        this.setState({ [attr.name]: null })\r\n      })\r\n    }\r\n  }\r\n\r\n  setAttr (item, name) {\r\n    this.setState({ attrPicked: true })\r\n    this.setState({ [name]: item.value })\r\n  }\r\n\r\n  render () {   \r\n    const product = this.state.item;\r\n    const stock = this.state.attrPicked && product.inStock    \r\n    return (\r\n      product\r\n        ? (<div>\r\n          <div className=\"product-container\">\r\n            <Gallery gallery={product.gallery} stock={product.inStock}/>\r\n            <div className=\"product-about\">\r\n              <div className=\"single-product-name\">\r\n                  <span>{product.brand}</span>\r\n                  <p>{product.name}</p>\r\n              </div>\r\n              <div className=\"single-product-attributes\">\r\n                {!product.attributes.length\r\n                  ? null\r\n                  : product.attributes.map((item, index) => (\r\n                    <AttrSet\r\n                      key={`${item.name}_${index}`}\r\n                      item = {item}\r\n                      setAttr={this.setAttr}\r\n                    />\r\n                  ))\r\n                }\r\n              </div>\r\n              <ProductPrice prices = {product.prices}/>\r\n              <button\r\n                disabled={!stock}\r\n                className={`add-to-cart-single ${!stock ? 'btn-disabled' : ''}`}\r\n                onClick={() => { this.addToCart(product) }}\r\n              >\r\n              add to cart</button>\r\n              <div className=\"single-product-description\" >\r\n                {ReactHtmlParser(product.description)}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        ) \r\n        : null\r\n    )\r\n  }\r\n}\r\nexport default injectProduct(productSingle)\r\n\r\n\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}